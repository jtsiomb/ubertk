#!/bin/sh

prefix=/usr/local
opt=true
dbg=true

while [ $# != 0 ]; do
	case $1 in
	--prefix=*)
		prefix=`echo $1 | sed 's/^--prefix=//'`
		;;
	--enable-opt)
		opt=true
		;;
	--disable-opt)
		opt=false
		;;
	--enable-dbg)
		dbg=true
		;;
	--disable-dbg)
		dbg=false
		;;
	esac
	shift
done

echo "installation prefix: $prefix"
$opt && echo 'optimizations: yes' || echo 'optimizations: no'
$dbg && echo 'debug symbols: yes' || echo 'debug symbols: no'

echo "Configuring ubertk..."

echo "# do not modify this file manually, it's generated by the configure script" >Makefile
echo "PREFIX = $prefix" >>Makefile
$opt && echo '-O3' | xargs echo 'opt =' >>Makefile
$dbg && echo '-g' | xargs echo 'dbg =' >>Makefile
echo '# --- end of generated part, start of Makefile.in ---' >>Makefile
cat Makefile.in >>Makefile

echo 'Done. Run make (or gmake) to compile.'
